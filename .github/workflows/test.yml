name: test

on:
  push:
    branches: [ "dev" ]
  pull_request:
    branches: [ "dev" ]
  schedule:
    - cron: '0 0 */16 * *'  
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Install Surfboard
        run: |
          npm install --location=global @waves/surfboard
          ls /usr/bin
          surfboard --version

      - name: Start a Private Node
        run:  docker run -d -p 6869:6869 wavesplatform/waves-private-node

      - name: Start a Waves Explorer
        run:  docker run -d -e API_NODE_URL=http://localhost:6869 -e NODE_LIST=http://localhost:6869 -p 3000:8080 wavesplatform/explorer

      - name: Run tests
        run:  surfboard test
